<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Notes • Rancher Demo</title>
<style>
body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 2rem; }
form { display:flex; gap:.5rem; margin-bottom:1rem; }
input { flex:1; padding:.6rem; }
button { padding:.6rem 1rem; }
ul { list-style:none; padding:0; }
li { padding:.5rem .75rem; border:1px solid #ddd; border-radius:.5rem; margin-bottom:.5rem; }
.muted { color:#666 }
</style>
</head>
<body>
<h1>Notes (Frontend → Backend → Postgres)</h1>
<form id="noteForm">
<input id="content" placeholder="Type a note…" />
<button type="submit">Add</button>
</form>
<p class="muted">Backend health: <span id="health">checking…</span></p>
<ul id="list"></ul>


<script>
async function api(path, options={}) {
const res = await fetch(path, { headers:{'Content-Type':'application/json'}, ...options });
if(!res.ok) throw new Error(await res.text());
return res.json();
}
async function refresh() {
try { const notes = await api('/api/notes');
const ul = document.getElementById('list'); ul.innerHTML='';
notes.forEach(n => {
const li = document.createElement('li');
li.textContent = `#${n.id} – ${n.content} (at ${new Date(n.created_at).toLocaleString()})`;
ul.appendChild(li);
});
} catch(e){ console.error(e); }
}
async function checkHealth(){
try { const h = await api('/api/health'); document.getElementById('health').textContent = h.status }
catch{ document.getElementById('health').textContent = 'down' }
}
document.getElementById('noteForm').addEventListener('submit', async (e)=>{
e.preventDefault();
const i = document.getElementById('content'); const v = i.value.trim(); if(!v) return;
await api('/api/notes', { method:'POST', body: JSON.stringify({content:v}) });
i.value='';
await refresh();
});
checkHealth();
refresh();
</script>
</body>
</html>
